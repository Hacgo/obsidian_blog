---
tags:
  - 간바레
  - 비바엔에스
cssclasses:
  - 윤원일선임
  - 정준혁매니저
aliases:
---
## ※ 시나리오 정보
1. 시나리오명
		1)실행 시나리오(Ebot)
		- 영업팀_HKMC(현대) 울산(엔진)납품카드발행,출력_울산1
		- 영업팀_HKMC(현대) 울산(변속기,5)납품카드발행,출력_울산2
		- 영업팀_HKMC(현대) 울산(1,2,3,4)납품카드발행,출력_울산3
		2)관리 시나리오(Schedule)
		- System_Restart
		- SSL(VPN) Check
		
---
2. 사용 코드
		- 항목분류.py
			(고객사 양식으로 가공하는 코드)
		- 울산총합.py
			(경로안의 엑셀을 병합하는코드)
		- 추가납입.py
			(같은 하치장의 품번이 존재할 경우, 계산하는 코드)
		- Checking_Factory.py
			(미출하 공장을 체크하는 코드입니다. [하치장정보.xlsx])
		- Sunil_Account.py
			(excel의 계정정보를 변수로 받는 코드)
		- ~~Yesterday_excel.py~~
			~~(현재 : 출력시나리오 중지로 인하여사용 중지)~~
		- 하치장별분류.py
			([Arguments = 공장변수]를 입력 받아서 분열 가공하는 코드)
		- Delete_Folder.py
			(처리 완료된 빈 폴더를 제거하는 코드)
			
---
3. 시나리오 설명
		1) ERP에서 xls 파일을 전부 다운로드 받는다.
		![[울산 ERP 거래처 체크.png]]
		2) Excel을 전부 합치고(추가납입)
		![[ERP 다운로드 자료.png]]
		3) 같은(하치장,품번)이 존재할 경우 두 값(추가납입포함)을 합쳐서
		    울산총합.xlsx 파일을 생성한다.
		![[ERP 총합파일 가공.png]]
		4) WebVPN을 실행(과거 Pulse, Ivanti vpn에 비해 안정성이 조금 떨어짐)
		![[SCM(WebVpn)기본 화면.png]]
		5) 크롬을 종료후에 HKMC 사이트 로그인 접속을 진행
		6) 소요량 미포함 선택 및 공장선택(대분류)
		7) 
		![[HKMC 조회시 체크 목록.png]]
		7) HKMC 사이트에서 다운로드한 엑셀데이터를 기준으로 가공된 엑셀 데이터를 생성합니다.
		![[HKMC다운로드된 엑셀 자료.png]]
		8) 가공된 엑셀은 7)번 엑셀을 기준으로 품번이 생성이 됩니다.
		![[HKMC자료 순서를 기준으로 파일가공.png]]예시)울산완성차1공장.xlsx

---

## ※ 특이사항
1) 품번 가공을 진행하는 이유
	선일다이파스 품번 = 고객사(HKMC)의 품번 매칭이 100% 이루어 지지 않습니다.
	예시) C-84433-3B000 = 84433-3B000
2) VPN 변경 이력이 자주 존재해왔습니다. 혹여나 나중에도 변경될 수도 있습니다.
	[ 23년6월(Pulse VPN) / 23년도11월(Ivanti VPN) / 24년도5월(SCM VPN) ]
3) 관리자 팝업 및 이상한 팝업이 자주 생성됩니다. 
	- 그냥 다시 진행 시에 정상 작동할 확률이 높습니다.
		(로직으로 실패시에 폴더안의 파일을 기준으로 재실행 해두도록 되어있습니다.)
4) 셀레니움을 사용하거나 JavaScript를 통해서 입력을 진행하면 되지 않나?
![[(울산)입력 영상.gif]]
	(네 안 됩니다. 사이트 개편되면 도전해 보세요. 저도 수동으로 하기 싫었습니다.)
5) 시나리오명에 HKMC(기아 or 현대)가 포함되어 있으면 하나가 문제가 생길 경우 전부다 수정해야 할 수도 있습니다.
6) 마지막으로 항상 문제가 있을 경우는 최소한 1~3일은 같이 모니터링 해주는 것이 좋습니다.
