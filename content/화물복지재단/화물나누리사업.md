---
tags:
  - 안태훈
share_link: https://share.note.sx/vfnj1ikg#uE7mWrYXOtgynNvPkf678eA9W5LMW9YNW4bnlA1jkCQ
share_updated: 2025-02-18T14:42:25+09:00
---
## 화물나누리사업(주민번호,민감정보)마스킹

#### 원본
- 작성자(안태훈) : https://confluence.vivans.net/pages/viewpage.action?pageId=34414286

*해당 시나리오의 경우 Schedule or Ebot으로 진행하는 시나리오가 아닙니다. 순수 Python Code로 api(NaverOcr)를 호출해서 시나리오를 진행하도록 되어있습니다.*
![[화물나누리 실행 방법.png]]

***해당 시나리오의 재개발이 필요합니다 .***
### 마스킹 조건
	   - 차주  : 차량등록증, 통장사본, 사업자등록증
	   - 주선사 : 사업자등록증, 주선면허증, 대표자신분증, 통장사본
	   - 운송사 : 사업자등록증, 운송면허증, 주선면허증, 국제물류주선업
	   - 화주  : 사업자등록증, 운송면허증, 주선면허증, 국제물류주선업

#### 문제점
1) 초기 개발시 민감정보(주민번호)가 존재시에 파일의 형식과 상관없이 모든 주민번호 뒷자리를 제거하도록 되어있습니다. 위의 마스킹 조건이 적용되어 있지 않습니다.
2) 파일 백업 로직에도 문제가 있습니다.
	a) C:/UserDummy/[3만건 이상의 유저 정보] 기본데이터 경로의 파일을 전부 읽어들입니다.
	b) C:/backup 으로 파일을 옮깁니다.
	c) ※문제※ 다음 실행시에 C:/UserDummy/[3만건 이상의 유저 정보] 를 가공하여서 저장합니다.
	**d) ※중요※ [3만건 이상의 유저정보]가 재실행을 통해서 자료가 가공되어서 원본파일이 훼손되어있습니다.** 
	f) 25년 초에 다시 개발 계획을 잡으셔야합니다.
3) NaverOcr - 월마다 기본 100건 무료 이후 건당 3원 의 이슈로 24년 5월 중순에 EasyOcr로 새로이 적용되어 사용하였습니다. 
4) 10월31일 api 호출시 EasyOcr 서버에서 송출 이슈가 존재하여서 실행 중간중간 재실행을 함으로써 시나리오 실행 시간이 2주정도 소모 되고 정확도 문제로 인하여 NaverOcr로 다시 수정하였습니다.
	
	![[구)화물나누리 Panding.png]]

	(위와 같은 이슈가 발생하는 이유는 api 호출 이후에 자료를 보내고 자료를 못받게 되어서 생긴 이슈입니다. EasyOcr 문제에 관해서는 채문창 부사장님 / 박병구 매니저님)
5) 확장자 이슈(아이폰(heic, pdf)등의 확장자의 이슈로 인하여 ocrconvert.py코드를 실행해 주어야합니다.) 또한 확인되지 않은 다른 확장자의 경우는 ocrconvert.py코드 수정이 필요합니다.
#### 실패하는 이유
- EasyOcr 서버의 경우는 다른 유료 OCR 서비스 보다 품질이 좋다고 할수는 없습니다. 
	(서버 자체에서 값을 송신후에 수신 부분에서 문제가 발생하면 위의 그림과 같이 Pending 창이 무제한으로 반복됩니다. 3초마다 수신을 요청하지만 자료는 받을 수 없는 상황이 발생합니다. 위와같은 문제가 확인되었을 경우는 코드를 다시 재실행 하는 방법밖에는 현재는 없습니다.)